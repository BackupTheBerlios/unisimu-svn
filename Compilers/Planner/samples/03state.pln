{
    sub say { print @_, "\n"; }
    process('a');
}

var state;

start :
    { $state eq 'a' }
    { say ("starting now..."); $state = 'b'; }

    next :  
        { $state eq 'b' }
        { say ("next, i should..."); $state = 'c'; }

    then :
        { $state eq 'c' }
        { say ("and then..."); $state = 'd'; }

end :
    { $state eq 'd' }
    { say ("finally..."); $state = 'a'; }

(start | next | then | end){8};
